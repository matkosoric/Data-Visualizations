{"paragraphs":[{"text":"val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n\n\nval df = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"hdfs:///user/zeppelin/Library_Usage.csv\")\n\nval newNames = Seq(\"Patron_Type_Code\", \"Patron_Type_Definition\", \"Total_Checkouts\", \"Total_Renewals\", \"Age_Range\", \"Home_Library_Code\", \"Home_Library_Definition\", \"Circulation_Active_Month\", \"Circulation_Active_Year\", \"Notice_Preference_Code\", \"Notice_Preference_Definition\", \"Provided_Email_Address\", \"Year_Patron_Registered\", \"Outside_of_County\", \"Supervisor_District\")\n\nval dfRenamed = df.toDF(newNames: _*).na.drop\n","user":"anonymous","dateUpdated":"2018-09-14T13:59:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@677abe73\ndf: org.apache.spark.sql.DataFrame = [Patron Type Code: string, Patron Type Definition: string ... 13 more fields]\nnewNames: Seq[String] = List(Patron_Type_Code, Patron_Type_Definition, Total_Checkouts, Total_Renewals, Age_Range, Home_Library_Code, Home_Library_Definition, Circulation_Active_Month, Circulation_Active_Year, Notice_Preference_Code, Notice_Preference_Definition, Provided_Email_Address, Year_Patron_Registered, Outside_of_County, Supervisor_District)\ndfRenamed: org.apache.spark.sql.DataFrame = [Patron_Type_Code: string, Patron_Type_Definition: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1536867101844_122418298","id":"20180913-193141_1327891135","dateCreated":"2018-09-13T19:31:41+0000","dateStarted":"2018-09-14T13:59:31+0000","dateFinished":"2018-09-14T14:00:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6407"},{"text":"dfRenamed.createOrReplaceTempView(\"library\")\n\ndfRenamed.printSchema\n\ndf.show\n\n\n\n","user":"anonymous","dateUpdated":"2018-09-14T13:59:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Patron_Type_Code: string (nullable = true)\n |-- Patron_Type_Definition: string (nullable = true)\n |-- Total_Checkouts: string (nullable = true)\n |-- Total_Renewals: string (nullable = true)\n |-- Age_Range: string (nullable = true)\n |-- Home_Library_Code: string (nullable = true)\n |-- Home_Library_Definition: string (nullable = true)\n |-- Circulation_Active_Month: string (nullable = true)\n |-- Circulation_Active_Year: string (nullable = true)\n |-- Notice_Preference_Code: string (nullable = true)\n |-- Notice_Preference_Definition: string (nullable = true)\n |-- Provided_Email_Address: string (nullable = true)\n |-- Year_Patron_Registered: string (nullable = true)\n |-- Outside_of_County: string (nullable = true)\n |-- Supervisor_District: string (nullable = true)\n\n+----------------+----------------------+---------------+--------------+--------------+-----------------+-----------------------+------------------------+-----------------------+----------------------+----------------------------+----------------------+----------------------+-----------------+-------------------+\n|Patron Type Code|Patron Type Definition|Total Checkouts|Total Renewals|     Age Range|Home Library Code|Home Library Definition|Circulation Active Month|Circulation Active Year|Notice Preference Code|Notice Preference Definition|Provided Email Address|Year Patron Registered|Outside of County|Supervisor District|\n+----------------+----------------------+---------------+--------------+--------------+-----------------+-----------------------+------------------------+-----------------------+----------------------+----------------------------+----------------------+----------------------+-----------------+-------------------+\n|               3|                SENIOR|             28|            13|65 to 74 years|                X|           Main Library|                November|                   2012|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|             21|            10|55 to 59 years|                X|           Main Library|                 October|                   2015|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            275|           559|60 to 64 years|                X|           Main Library|                 January|                   2015|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|             73|            38|45 to 54 years|               M8|            Mission Bay|                February|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            182|            90|45 to 54 years|                X|           Main Library|                    July|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               3|                SENIOR|              1|             0|65 to 74 years|                X|           Main Library|                    July|                   2004|                     z|                       email|                  true|                  2003|             true|               null|\n|              16|   DIGITAL ACCESS CARD|             31|             4|65 to 74 years|               P7|                Potrero|                 January|                   2012|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            547|           177|60 to 64 years|                X|           Main Library|                    July|                   2016|                     p|                       phone|                 false|                  2003|             true|               null|\n|               0|                 ADULT|             28|             1|60 to 64 years|                X|           Main Library|                December|                   2015|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|             77|             3|60 to 64 years|                X|           Main Library|                    July|                   2016|                     z|                       email|                  true|                  2003|             true|               null|\n|               3|                SENIOR|            593|             9|65 to 74 years|                X|           Main Library|               September|                   2014|                     p|                       phone|                 false|                  2003|            false|               null|\n|               3|                SENIOR|            784|           589|65 to 74 years|               S7|                 Sunset|                    July|                   2016|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|            601|           702|55 to 59 years|                X|           Main Library|                    July|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               3|                SENIOR|              2|             6|65 to 74 years|               S7|                 Sunset|                     May|                   2005|                     a|                       print|                 false|                  2003|             true|               null|\n|               0|                 ADULT|             99|           226|45 to 54 years|                X|           Main Library|                    July|                   2014|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|             84|            24|45 to 54 years|                X|           Main Library|                  August|                   2015|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            369|           278|55 to 59 years|               M4|                 Merced|                    July|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               3|                SENIOR|             65|             8|65 to 74 years|               N4|   Noe Valley/Sally ...|                February|                   2016|                     p|                       phone|                 false|                  2003|            false|               null|\n|               0|                 ADULT|            147|            89|55 to 59 years|               E9|              Excelsior|                   March|                   2016|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|             93|            64|60 to 64 years|                X|           Main Library|                February|                   2015|                     z|                       email|                  true|                  2003|             true|               null|\n+----------------+----------------------+---------------+--------------+--------------+-----------------+-----------------------+------------------------+-----------------------+----------------------+----------------------------+----------------------+----------------------+-----------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1536867179846_1340223543","id":"20180913-193259_256674431","dateCreated":"2018-09-13T19:32:59+0000","dateStarted":"2018-09-14T13:59:33+0000","dateFinished":"2018-09-14T14:00:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6408"},{"text":"%spark2.sql\nSELECT Age_Range, \n    SUM (CASE \n        WHEN Provided_Email_Address= 'true' THEN 1\n        ELSE 0\n    END) AS `with e-mail`,\n    SUM (CASE \n        WHEN Provided_Email_Address= 'false' THEN 1\n        ELSE 0\n    END) AS `without e-mail`\nFROM library\nGROUP BY Age_Range \nORDER BY Age_Range","user":"anonymous","dateUpdated":"2018-09-14T13:59:33+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false},"pieChart":{}},"commonSetting":{},"keys":[{"name":"Age_Range","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"with e-mail","index":1,"aggr":"sum"},{"name":"without e-mail","index":2,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Age_Range\twith e-mail\twithout e-mail\n0 to 9 years\t24097\t8262\n10 to 19 years\t30874\t15031\n20 to 24 years\t18118\t3555\n25 to 34 years\t60201\t6806\n35 to 44 years\t43058\t5917\n45 to 54 years\t30280\t7044\n55 to 59 years\t10477\t3838\n60 to 64 years\t9574\t4049\n65 to 74 years\t14217\t6909\n75 years and over\t4993\t5668\n"}]},"apps":[],"jobName":"paragraph_1536867658426_-958716244","id":"20180913-194058_475389809","dateCreated":"2018-09-13T19:40:58+0000","dateStarted":"2018-09-14T14:00:11+0000","dateFinished":"2018-09-14T14:01:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6409"},{"text":"%spark2.sql\n\nSELECT sum(Total_Checkouts) total, Home_Library_Definition\nFROM library\nGROUP BY Home_Library_Definition\nORDER BY total DESC\n--LIMIT 20","user":"anonymous","dateUpdated":"2018-09-14T14:20:10+0000","config":{"colWidth":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":800,"optionOpen":true,"setting":{"pieChart":{},"scatterChart":{"xAxis":{"name":"total","index":0,"aggr":"sum"},"yAxis":{"name":"Home_Library_Definition","index":1,"aggr":"sum"},"size":{"name":"total","index":0,"aggr":"sum"}},"multiBarChart":{"stacked":true}},"keys":[],"groups":[{"name":"Home_Library_Definition","index":1,"aggr":"sum"}],"values":[{"name":"total","index":0,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"total\tHome_Library_Definition\n9512505.0\tMain Library\n4887237.0\tChinatown\n4066836.0\tRichmond\n3696252.0\tOrtega\n3038969.0\tSunset\n2710949.0\tMission\n2655626.0\tWest Portal\n2324834.0\tExcelsior\n1959368.0\tParkside\n1867054.0\tPortola\n1734377.0\tIngleside\n1615104.0\tMerced\n1530267.0\tAnza\n1493389.0\tGlen Park\n1372120.0\tEureka Valley/Harvey Milk Memorial\n1327777.0\tNorth Beach\n1225470.0\tBernal Heights\n1206003.0\tWestern Addition\n1204378.0\tNoe Valley/Sally Brunn\n1043482.0\tVisitacion Valley\n1040632.0\tMarina\n993529.0\tPark\n905370.0\tPresidio\n769854.0\tPotrero\n719751.0\tMission Bay\n486178.0\tGolden Gate Valley\n412889.0\tBayview/Linda Brooks-Burton\n409966.0\tOcean View\n313932.0\tUnknown\n109698.0\tChildren's Bookmobile\n85030.0\tLibrary on Wheels\n8325.0\tBranch Bookmobile (West Portal)\n5038.0\tBranch Bookmobile (Excelsior)\n4569.0\tBranch Bookmobile (Sunset)\n1725.0\tBranch Bookmobile (Marina)\n"}]},"apps":[],"jobName":"paragraph_1536868043203_-568076806","id":"20180913-194723_215880362","dateCreated":"2018-09-13T19:47:23+0000","dateStarted":"2018-09-14T14:20:10+0000","dateFinished":"2018-09-14T14:20:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6410"},{"text":"%spark2.sql\n\n\n--SELECT * FROM library\n\nSELECT Patron_Type_Definition, SUM (Total_Checkouts) num_checkouts\nFROM library\nWHERE Patron_Type_Definition IN ('ADULT', 'SENIOR', 'JUVENILE', 'YOUNG ADULT', 'STAFF', 'SPECIAL')\nGROUP BY Patron_Type_Definition\nORDER BY num_checkouts DESC\n\n","user":"anonymous","dateUpdated":"2018-09-14T14:35:31+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":true,"setting":{"pieChart":{},"stackedAreaChart":{"style":"stack"},"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"Patron_Type_Definition","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"num_checkouts","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Patron_Type_Definition\tnum_checkouts\nADULT\t3.0170796E7\nSENIOR\t1.0386963E7\nJUVENILE\t9185079.0\nYOUNG ADULT\t6180189.0\nSTAFF\t227037.0\nSPECIAL\t215885.0\n"}]},"apps":[],"jobName":"paragraph_1536933721579_1269824820","id":"20180914-140201_84047895","dateCreated":"2018-09-14T14:02:01+0000","dateStarted":"2018-09-14T14:34:34+0000","dateFinished":"2018-09-14T14:34:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6411"},{"text":"%spark2.sql\n","user":"anonymous","dateUpdated":"2018-09-14T14:15:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1536934516200_481408093","id":"20180914-141516_387214258","dateCreated":"2018-09-14T14:15:16+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:6412"}],"name":"San Francisco Library","id":"2DSC9UAHE","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}