{"paragraphs":[{"text":"val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n\n\nval df = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"hdfs:///user/zeppelin/Library_Usage.csv\")\n\nval newNames = Seq(\"Patron_Type_Code\", \"Patron_Type_Definition\", \"Total_Checkouts\", \"Total_Renewals\", \"Age_Range\", \"Home_Library_Code\", \"Home_Library_Definition\", \"Circulation_Active_Month\", \"Circulation_Active_Year\", \"Notice_Preference_Code\", \"Notice_Preference_Definition\", \"Provided_Email_Address\", \"Year_Patron_Registered\", \"Outside_of_County\", \"Supervisor_District\")\n\nval dfRenamed = df.toDF(newNames: _*).na.drop\n","user":"anonymous","dateUpdated":"2018-09-13T20:33:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@1232fcd3\ndf: org.apache.spark.sql.DataFrame = [Patron Type Code: string, Patron Type Definition: string ... 13 more fields]\nnewNames: Seq[String] = List(Patron_Type_Code, Patron_Type_Definition, Total_Checkouts, Total_Renewals, Age_Range, Home_Library_Code, Home_Library_Definition, Circulation_Active_Month, Circulation_Active_Year, Notice_Preference_Code, Notice_Preference_Definition, Provided_Email_Address, Year_Patron_Registered, Outside_of_County, Supervisor_District)\ndfRenamed: org.apache.spark.sql.DataFrame = [Patron_Type_Code: string, Patron_Type_Definition: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1536867101844_122418298","id":"20180913-193141_1327891135","dateCreated":"2018-09-13T19:31:41+0000","dateStarted":"2018-09-13T20:33:51+0000","dateFinished":"2018-09-13T20:33:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17597"},{"text":"dfRenamed.createOrReplaceTempView(\"library\")\n\ndfRenamed.printSchema\n\ndf.show\n\n\n\n","user":"anonymous","dateUpdated":"2018-09-13T20:33:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Patron_Type_Code: string (nullable = true)\n |-- Patron_Type_Definition: string (nullable = true)\n |-- Total_Checkouts: string (nullable = true)\n |-- Total_Renewals: string (nullable = true)\n |-- Age_Range: string (nullable = true)\n |-- Home_Library_Code: string (nullable = true)\n |-- Home_Library_Definition: string (nullable = true)\n |-- Circulation_Active_Month: string (nullable = true)\n |-- Circulation_Active_Year: string (nullable = true)\n |-- Notice_Preference_Code: string (nullable = true)\n |-- Notice_Preference_Definition: string (nullable = true)\n |-- Provided_Email_Address: string (nullable = true)\n |-- Year_Patron_Registered: string (nullable = true)\n |-- Outside_of_County: string (nullable = true)\n |-- Supervisor_District: string (nullable = true)\n\n+----------------+----------------------+---------------+--------------+--------------+-----------------+-----------------------+------------------------+-----------------------+----------------------+----------------------------+----------------------+----------------------+-----------------+-------------------+\n|Patron Type Code|Patron Type Definition|Total Checkouts|Total Renewals|     Age Range|Home Library Code|Home Library Definition|Circulation Active Month|Circulation Active Year|Notice Preference Code|Notice Preference Definition|Provided Email Address|Year Patron Registered|Outside of County|Supervisor District|\n+----------------+----------------------+---------------+--------------+--------------+-----------------+-----------------------+------------------------+-----------------------+----------------------+----------------------------+----------------------+----------------------+-----------------+-------------------+\n|               3|                SENIOR|             28|            13|65 to 74 years|                X|           Main Library|                November|                   2012|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|             21|            10|55 to 59 years|                X|           Main Library|                 October|                   2015|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            275|           559|60 to 64 years|                X|           Main Library|                 January|                   2015|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|             73|            38|45 to 54 years|               M8|            Mission Bay|                February|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            182|            90|45 to 54 years|                X|           Main Library|                    July|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               3|                SENIOR|              1|             0|65 to 74 years|                X|           Main Library|                    July|                   2004|                     z|                       email|                  true|                  2003|             true|               null|\n|              16|   DIGITAL ACCESS CARD|             31|             4|65 to 74 years|               P7|                Potrero|                 January|                   2012|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            547|           177|60 to 64 years|                X|           Main Library|                    July|                   2016|                     p|                       phone|                 false|                  2003|             true|               null|\n|               0|                 ADULT|             28|             1|60 to 64 years|                X|           Main Library|                December|                   2015|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|             77|             3|60 to 64 years|                X|           Main Library|                    July|                   2016|                     z|                       email|                  true|                  2003|             true|               null|\n|               3|                SENIOR|            593|             9|65 to 74 years|                X|           Main Library|               September|                   2014|                     p|                       phone|                 false|                  2003|            false|               null|\n|               3|                SENIOR|            784|           589|65 to 74 years|               S7|                 Sunset|                    July|                   2016|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|            601|           702|55 to 59 years|                X|           Main Library|                    July|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               3|                SENIOR|              2|             6|65 to 74 years|               S7|                 Sunset|                     May|                   2005|                     a|                       print|                 false|                  2003|             true|               null|\n|               0|                 ADULT|             99|           226|45 to 54 years|                X|           Main Library|                    July|                   2014|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|             84|            24|45 to 54 years|                X|           Main Library|                  August|                   2015|                     z|                       email|                  true|                  2003|            false|               null|\n|               0|                 ADULT|            369|           278|55 to 59 years|               M4|                 Merced|                    July|                   2016|                     z|                       email|                  true|                  2003|            false|               null|\n|               3|                SENIOR|             65|             8|65 to 74 years|               N4|   Noe Valley/Sally ...|                February|                   2016|                     p|                       phone|                 false|                  2003|            false|               null|\n|               0|                 ADULT|            147|            89|55 to 59 years|               E9|              Excelsior|                   March|                   2016|                     z|                       email|                  true|                  2003|             true|               null|\n|               0|                 ADULT|             93|            64|60 to 64 years|                X|           Main Library|                February|                   2015|                     z|                       email|                  true|                  2003|             true|               null|\n+----------------+----------------------+---------------+--------------+--------------+-----------------+-----------------------+------------------------+-----------------------+----------------------+----------------------------+----------------------+----------------------+-----------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1536867179846_1340223543","id":"20180913-193259_256674431","dateCreated":"2018-09-13T19:32:59+0000","dateStarted":"2018-09-13T20:33:59+0000","dateFinished":"2018-09-13T20:34:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17598"},{"text":"%spark2.sql\nSELECT Age_Range, \n    SUM (CASE \n        WHEN Provided_Email_Address= 'true' THEN 1\n        ELSE 0\n    END) AS `with e-mail`,\n    SUM (CASE \n        WHEN Provided_Email_Address= 'false' THEN 1\n        ELSE 0\n    END) AS `without e-mail`\nFROM library\nGROUP BY Age_Range \nORDER BY Age_Range","user":"anonymous","dateUpdated":"2018-09-13T20:34:34+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false},"pieChart":{}},"commonSetting":{},"keys":[{"name":"Age_Range","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"with e-mail","index":1,"aggr":"sum"},{"name":"without e-mail","index":2,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Age_Range\twith e-mail\twithout e-mail\n0 to 9 years\t24097\t8262\n10 to 19 years\t30874\t15031\n20 to 24 years\t18118\t3555\n25 to 34 years\t60201\t6806\n35 to 44 years\t43058\t5917\n45 to 54 years\t30280\t7044\n55 to 59 years\t10477\t3838\n60 to 64 years\t9574\t4049\n65 to 74 years\t14217\t6909\n75 years and over\t4993\t5668\n"}]},"apps":[],"jobName":"paragraph_1536867658426_-958716244","id":"20180913-194058_475389809","dateCreated":"2018-09-13T19:40:58+0000","dateStarted":"2018-09-13T20:34:03+0000","dateFinished":"2018-09-13T20:34:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17599"},{"text":"","user":"anonymous","dateUpdated":"2018-09-13T20:09:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1536868043203_-568076806","id":"20180913-194723_215880362","dateCreated":"2018-09-13T19:47:23+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:17600"}],"name":"San Francisco Library - E-mail per age group","id":"2DSC9UAHE","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}