{"paragraphs":[{"text":"import org.apache.spark.sql.functions.regexp_replace\n\n\nval sqlContext = new org.apache.spark.sql.SQLContext(sc)\n\n/*\nval df = spark.read.format(\"csv\")\n            .option(\"header\", \"true\")\n            .option(\"encoding\", \"Windows-1250\")\n            .option(\"sep\", \";\")\n            .option(\"inferSchema\", \"true\")\n            .load(\"hdfs:///data/registar_biraca.csv\")\n            \ndf.write.format(\"parquet\")\n.option(\"compression\",\"gzip\")\n.save(\"hdfs:///data/registar_biraca.parquet\")\n*/\n\nval df = spark.read.format(\"parquet\")\n            .option(\"header\", \"true\")\n            .option(\"encoding\", \"Windows-1250\")\n            .option(\"sep\", \";\")\n            .option(\"inferSchema\", \"true\")\n            .load(\"hdfs:///data/registar_biraca.parquet\")\n","user":"anonymous","dateUpdated":"2018-09-14T04:56:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.regexp_replace\nwarning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@706604ab\ndf: org.apache.spark.sql.DataFrame = [ZUPANIJA_NAZIV: string, GROP_NAZIV: string ... 7 more fields]\n"}]},"apps":[],"jobName":"paragraph_1536889974249_-1188265124","id":"20180914-015254_1664310881","dateCreated":"2018-09-14T01:52:54+0000","dateStarted":"2018-09-14T04:55:24+0000","dateFinished":"2018-09-14T04:55:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:308"},{"text":"df.printSchema()\ndf.show(30)","user":"anonymous","dateUpdated":"2018-09-14T05:28:31+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":494.2,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false},"stackedAreaChart":{}},"commonSetting":{},"keys":[],"groups":[],"values":[]},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ZUPANIJA_NAZIV: string (nullable = true)\n |-- GROP_NAZIV: string (nullable = true)\n |-- NASELJE_NAZIV: string (nullable = true)\n |-- ULICA_NAZIV: string (nullable = true)\n |-- ADR_KBR: integer (nullable = true)\n |-- ADR_KBR_DODA: string (nullable = true)\n |-- ADR_KBR_DODN: string (nullable = true)\n |-- BROJ_BIRACA: integer (nullable = true)\n |-- STATUS: string (nullable = true)\n\n+--------------------+----------+-------------+------------+-------+------------+------------+-----------+------+\n|      ZUPANIJA_NAZIV|GROP_NAZIV|NASELJE_NAZIV| ULICA_NAZIV|ADR_KBR|ADR_KBR_DODA|ADR_KBR_DODN|BROJ_BIRACA|STATUS|\n+--------------------+----------+-------------+------------+-------+------------+------------+-----------+------+\n|ZADARSKA         ...|       VIR|          VIR|  ROSULJE VI|     28|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|ROSULJE VIII|      5|        null|        null|          2|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|ROSULJE VIII|     10|        null|        null|          4|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SAPAVAC|      7|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SAPAVAC|      9|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SAPAVAC|     12|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SITE VI|      2|        null|        null|          2|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SITE VI|      8|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SITE VI|     21|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SITE VI|     23|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SITE VI|     24|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|     SITE VI|     25|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|    SITE XIV|     10|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXIV|      2|        null|        null|          5|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXIV|     13|        null|        null|          7|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXIV|     18|            |            |          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXIV|     24|           A|        null|          2|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXVI|      4|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXVI|      5|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXVI|      7|        null|        null|          3|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXVI|     14|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SITE XXVI|     15|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR| SITE XXVIII|      4|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR| SITE XXVIII|     10|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SLATINA I|      6|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SLATINA I|     12|        null|        null|          2|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SLATINA I|     15|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SLATINA I|     21|        null|        null|          4|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR|   SLATINA I|     22|        null|        null|          1|VAŽEĆA|\n|ZADARSKA         ...|       VIR|          VIR| SLATINA III|      3|        null|        null|          1|VAŽEĆA|\n+--------------------+----------+-------------+------------+-------+------------+------------+-----------+------+\nonly showing top 30 rows\n\n"}]},"apps":[],"jobName":"paragraph_1536890051484_249231743","id":"20180914-015411_1102691180","dateCreated":"2018-09-14T01:54:11+0000","dateStarted":"2018-09-14T05:28:31+0000","dateFinished":"2018-09-14T05:28:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:309"},{"text":"%md\n\n###  Top 10 ulica s najvećim brojem birača\n#### Top 10 streets with the biggest number of voters","user":"anonymous","dateUpdated":"2018-09-14T04:29:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Top 10 ulica s najvećim brojem birača</h3>\n<h4>Top 10 streets with the biggest number of voters</h4>\n"}]},"apps":[],"jobName":"paragraph_1536894514883_-194515446","id":"20180914-030834_398309085","dateCreated":"2018-09-14T03:08:34+0000","dateStarted":"2018-09-14T04:29:55+0000","dateFinished":"2018-09-14T04:29:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:310"},{"text":"%spark2.sql\n\n\nSELECT\n    NASELJE_NAZIV,\n    ULICA_NAZIV,\n    SUM(BROJ_BIRACA) broj_biraca\nFROM\n    registar\nGROUP BY\n    NASELJE_NAZIV,\n    ULICA_NAZIV\nORDER BY\n    broj_biraca DESC \nLIMIT 10\n\n\n","user":"anonymous","dateUpdated":"2018-09-14T04:21:36+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":492.4,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false},"pieChart":{},"scatterChart":{"xAxis":{"name":"NASELJE_NAZIV","index":0,"aggr":"sum"},"size":{"name":"bb","index":2,"aggr":"sum"}}},"keys":[{"name":"ULICA_NAZIV","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"broj_biraca","index":2,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"NASELJE_NAZIV\tULICA_NAZIV\tbroj_biraca\nZAGREB\tULICA BOŽIDARA MAGOVCA\t6785\nZAGREB\tILICA\t4878\nZAGREB\tTRNSKO\t4634\nSPLIT\tVUKOVARSKA\t4552\nOSIJEK\tSJENJAK\t4007\nSPLIT\tPUJANKE\t3531\nSPLIT\tHERCEGOVAČKA\t3396\nZAGREB\tULICA SV. MATEJA\t3319\nSPLIT\tMOSEĆKA\t3272\nSPLIT\tULICA ANTUNA BRANKA ŠIMIĆA\t3226\n"}]},"apps":[],"jobName":"paragraph_1536890066979_-1723745292","id":"20180914-015426_1654835449","dateCreated":"2018-09-14T01:54:26+0000","dateStarted":"2018-09-14T04:21:39+0000","dateFinished":"2018-09-14T04:21:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:311"},{"text":"%md\n\n###  Omjer birača po županijama\n#### Ratio of voters per county","user":"anonymous","dateUpdated":"2018-09-14T04:31:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Omjer birača po županijama</h3>\n<h4>Ratio of voters per county</h4>\n"}]},"apps":[],"jobName":"paragraph_1536894460516_1401160836","id":"20180914-030740_2059172070","dateCreated":"2018-09-14T03:07:40+0000","dateStarted":"2018-09-14T04:31:30+0000","dateFinished":"2018-09-14T04:31:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:312"},{"text":"%spark2.sql\n\n\nSELECT\n    ZUPANIJA_NAZIV,\n    SUM(BROJ_BIRACA) broj_biraca\nFROM\n    registar\nGROUP BY\n    ZUPANIJA_NAZIV\nORDER BY\n    broj_biraca DESC","user":"anonymous","dateUpdated":"2018-09-14T05:05:20+0000","config":{"colWidth":11,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":669,"optionOpen":true},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ZUPANIJA_NAZIV\tbroj_biraca\nGRAD ZAGREB                                       \t703847\nSPLITSKO-DALMATINSKA                              \t410464\nZAGREBAČKA                                       \t276478\nPRIMORSKO-GORANSKA                                \t266978\nOSJEČKO-BARANJSKA                                \t254434\nISTARSKA                                          \t187916\nZADARSKA                                          \t165173\nVUKOVARSKO-SRIJEMSKA                              \t151074\nVARAŽDINSKA                                      \t147298\nSISAČKO-MOSLAVAČKA                              \t144837\nBRODSKO-POSAVSKA                                  \t136940\nKARLOVAČKA                                       \t110629\nKRAPINSKO-ZAGORSKA                                \t109881\nDUBROVAČKO-NERETVANSKA                           \t109095\nŠIBENSKO-KNINSKA                                 \t99661\nBJELOVARSKO-BILOGORSKA                            \t98785\nMEĐIMURSKA                                       \t97054\nKOPRIVNIČKO-KRIŽEVAČKA                         \t94979\nVIROVITIČKO-PODRAVSKA                            \t71265\nPOŽEŠKO-SLAVONSKA                               \t65366\nLIČKO-SENJSKA                                    \t44231\n"}]},"apps":[],"jobName":"paragraph_1536890980102_403108877","id":"20180914-020940_1706686081","dateCreated":"2018-09-14T02:09:40+0000","dateStarted":"2018-09-14T04:21:40+0000","dateFinished":"2018-09-14T04:21:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:313"},{"text":"%md\n\n###  Top 10 najčešćih naziva ulica\n#### Top 10 most common street names","user":"anonymous","dateUpdated":"2018-09-14T04:33:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Top 10 najčešćih naziva ulica</h3>\n<h4>Top 10 most common street names</h4>\n"}]},"apps":[],"jobName":"paragraph_1536894453712_31824176","id":"20180914-030733_1739075266","dateCreated":"2018-09-14T03:07:33+0000","dateStarted":"2018-09-14T04:33:05+0000","dateFinished":"2018-09-14T04:33:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:314"},{"text":"// ujednačavanje stringova za iste ulice \n\nval df2 = df.withColumn(\"ULICA_NAZIV\", regexp_replace(df(\"ULICA_NAZIV\"), \"^(ULICA )\", \"\"))\nval df3 = df2.withColumn(\"ULICA_NAZIV\", regexp_replace(df2(\"ULICA_NAZIV\"), \"BRAĆE RADIĆA\", \"BRAĆE RADIĆ\"))\n\ndf3.createOrReplaceTempView(\"registar2\")\n\n\n","user":"anonymous","dateUpdated":"2018-09-14T04:33:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [ZUPANIJA_NAZIV: string, GROP_NAZIV: string ... 7 more fields]\ndf3: org.apache.spark.sql.DataFrame = [ZUPANIJA_NAZIV: string, GROP_NAZIV: string ... 7 more fields]\n"}]},"apps":[],"jobName":"paragraph_1536896069228_-1792756920","id":"20180914-033429_1986553158","dateCreated":"2018-09-14T03:34:29+0000","dateStarted":"2018-09-14T04:21:43+0000","dateFinished":"2018-09-14T04:21:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:315"},{"text":"%spark2.sql\n\nSELECT ulica, count(ulica) kolicina FROM\n(\nSELECT\nDISTINCT ULICA_NAZIV ulica,\nGROP_NAZIV grad_opcina\nFROM registar2\n)\nGROUP BY\n    ulica\nORDER BY\n    kolicina DESC\nLIMIT 10\n","user":"anonymous","dateUpdated":"2018-09-14T06:39:08+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":476,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"ulica","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"kolicina","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ulica\tkolicina\nMATIJE GUPCA\t205\nVLADIMIRA NAZORA\t194\nKRALJA TOMISLAVA\t170\nSTJEPANA RADIĆA\t155\nBRAĆE RADIĆ\t149\nLJUDEVITA GAJA\t133\nAUGUSTA ŠENOE\t131\nANTE STARČEVIĆA\t115\nKRALJA ZVONIMIRA\t108\nTINA UJEVIĆA\t99\n"}]},"apps":[],"jobName":"paragraph_1536893307981_594622408","id":"20180914-024827_1102039596","dateCreated":"2018-09-14T02:48:27+0000","dateStarted":"2018-09-14T06:34:56+0000","dateFinished":"2018-09-14T06:35:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:316"},{"text":"","user":"anonymous","dateUpdated":"2018-09-14T04:21:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1536894625078_501864739","id":"20180914-031025_1167603484","dateCreated":"2018-09-14T03:10:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:317"}],"name":"Croatian Electoral Register","id":"2DT6DEK6V","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}